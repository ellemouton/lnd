run:
  go: "1.22.6"

  # Abort after 10 minutes.
  timeout: 10m


linters-settings:
  custom:
    ll:
      type: "module"
      description: This is an example usage of a plugin linter.

linters:
  disable-all: true
  enable:
    - ll


issues:
  # Only show newly introduced problems.
  new-from-rev: 77c7f776d5cbf9e147edc81d65ae5ba177a684e5

  # Skip autogenerated files for mobile and gRPC as well as copied code for
  # internal use.
  skip-files:
    - "mobile\\/.*generated\\.go"
    - "\\.pb\\.go$"
    - "\\.pb\\.gw\\.go$"
    - "internal\\/musig2v040"

  skip-dirs:
    - channeldb/migration_01_to_11
    - channeldb/migration/lnwire21

  exclude-rules:
    # Exclude gosec from running for tests so that tests with weak randomness
    # (math/rand) will pass the linter.
    - path: _test\.go
      linters:
        - gosec
        - funlen
        - revive
        # Allow duplications in tests so it's easier to follow a single unit
        # test.
        - dupl

    - path: mock*
      linters:
        - revive
        # forcetypeassert is skipped for the mock because the test would fail
        # if the returned value doesn't match the type, so there's no need to
        # check the convert.
        - forcetypeassert

    - path: test*
      linters:
        - gosec
        - funlen

    # Allow duplicated code and fmt.Printf() in DB migrations.
    - path: channeldb/migration*
      linters:
        - dupl
        - forbidigo
        - godot

    # Allow duplicated code and fmt.Printf() in DB migration tests.
    - path: channeldb/migtest
      linters:
        - dupl
        - forbidigo
        - godot

    # Allow fmt.Printf() in commands.
    - path: cmd/commands/*
      linters:
        - forbidigo

    # Allow fmt.Printf() in config parsing.
    - path: config\.go
      linters:
        - forbidigo
    - path: lnd\.go
      linters:
        - forbidigo

    - path: lnmock/*
      linters:
        # forcetypeassert is skipped for the mock because the test would fail
        # if the returned value doesn't match the type, so there's no need to
        # check the convert.
        - forcetypeassert

    - path: mock*
      linters:
        # forcetypeassert is skipped for the mock because the test would fail
        # if the returned value doesn't match the type, so there's no need to
        # check the convert.
        - forcetypeassert
